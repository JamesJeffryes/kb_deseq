/*
A KBase module: kb_deseq
*/

module kb_deseq {

    /* A boolean - 0 for false, 1 for true.
        @range (0, 1)
    */
    typedef int boolean;

    /* An X/Y/Z style reference
    */
    typedef string obj_ref;

    typedef structure {
        string        condition_name;
        list<string>  expression_refs;
    } ExpressionConditionList;

    /*
      required params:
      expressionset_ref: ExpressionSet object reference
      diff_expression_obj_name: RNASeqDifferetialExpression object name
      filtered_expression_matrix_name: name of output object filtered expression matrix
      expr_condition_list: conditions for expression set object
      alpha_cutoff: q value cutoff
      num_threads: number of threads
      workspace_name: the name of the workspace it gets saved to

      optional params:
      fold_scale_type: one of ["linear", "log2+1", "log10+1"]
      fold_change_cutoff: fold change cutoff
    */
    typedef structure{
        obj_ref expressionset_ref;
        string diff_expression_obj_name;
        string filtered_expression_matrix_name;
        list<ExpressionConditionList> expr_condition_list;  
        float alpha_cutoff;
        int num_threads;
        string workspace_name;

        string fold_scale_type;
        float fold_change_cutoff;
    } DESeqInput;

    /*
        result_directory: folder path that holds all files generated by run_deseq2_app
        diff_expression_obj_ref: generated RNASeqDifferetialExpression object reference
        filtered_expression_matrix_ref: generated ExpressionMatrix object reference
        report_name: report name generated by KBaseReport
        report_ref: report reference generated by KBaseReport
    */
    typedef structure{
        string result_directory;
        obj_ref diff_expression_obj_ref;
        obj_ref filtered_expression_matrix_ref;
        string report_name;
        string report_ref;
    }DESeqResult;

    /*  
        run_deseq2_app: run DESeq2 app

        ref: https://www.bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html
    */
    funcdef run_deseq2_app(DESeqInput params)
        returns (DESeqResult returnVal) authentication required;
};
